---
author: "Suika"
title: "根分区快满了"
date: "2022-01-14 16:48:40"
description: "流程再完善不执行有卵用"
categories: "Tech"
tags: 
  - ""
image: ""
---
一个新上线的系统，50G的根分区用df看快满了，但业务说不可能有那么多数据。  
常规的思路，换du去看根下有什么大文件，可是`du -sh /*`的所有结果加起来都没有5G大。  
很自然就想到有进程删除了文件但没有释放，然后用`lsof`排查  
```
lsof | grep deleted
```
确实有几个进程，但是kill掉之后用df看，根分区还是满的。  
重启系统，依旧是……  

想了半天没有结果，最终发现是个lv挂载给了有数据的目录，而该目录在挂载lv之前就已经有数据了，所以是上线前检查不到位。

解决过程不需要重启，只需要如下操作 
把根分区挂载给/mnt：
```
mount -o bind / /mnt
```
查看此时/mnt下的文件大小  
```
du sh /mnt/*
```
此时会发现/mnt/point/中的文件大到占据了绝大多数根分区的空间，于是，删除或移走/mnt/point/下的文件。

至此问题解决。

