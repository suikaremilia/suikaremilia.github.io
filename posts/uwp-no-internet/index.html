<!DOCTYPE html>
<html lang="en-us" class="scroll-smooth">
    <head><meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>解决UWP应用无法联网的三种方法</title>
<meta name="description" content="怎么会有UWP这种东西">
<link rel="canonical" href="https://suikaremilia.github.io/posts/uwp-no-internet/">
<link rel="robots" href="/robots.txt" />
<link rel="stylesheet" href="https://suikaremilia.github.io/css/main.min.df1b948651de2b50af2bded0966d2d08b2a7217f36cbc0e2aaaaa9a7d2a94144.css" integrity="sha256-3xuUhlHeK1CvK97Qlm0tCLKnIX82y8Diqqqpp9KpQUQ=">
</head>
    <body class="max-w-screen-md px-10 mx-auto"><header class="flex flex-col sm:flex-row items-center gap-5 sm:gap-10 pt-16 py-12">
    

<figure class="flex-none w-20 h-20 rounded-full overflow-hidden" ><a href="https://suikaremilia.github.io/"><img srcset="/img/firefox_hub66cb162f84e73856336c19b5d2d497e_36921_80x80_fill_q90_box_smart1.jpg 80w" src="/img/firefox.jpg" width="640" height="640" alt="Red Panda YOLO"></a></figure>

    <div class="flex flex-col gap-5">
    <a href="https://suikaremilia.github.io/">
    
    <h3 class="text-center sm:text-left text-4xl font-extrabold text-gray-800 ">Red Panda YOLO</h3>
    
</a>
    <nav>
    <ul class="flex flex-wrap justify-center uppercase text-xs font-semibold gap-7 text-gray-500 ">
        
        
        <li class="hover:text-gray-500"><a href="/">Home</a></li>
        
        <li class="hover:text-gray-500"><a href="/posts">Posts</a></li>
        
        <li class="hover:text-gray-500"><a href="/murmur">Ｍurmur</a></li>
        
        <li class="hover:text-gray-500"><a href="/tags">Tags</a></li>
        
    </ul>
</nav>
    </div>
</header><div id="content">
<article class="flex flex-col gap-10">
    <header class="flex flex-col gap-2">
        <h2 class="text-4xl leading-snug font-bold text-gray-900">解决UWP应用无法联网的三种方法</h2>

        <div class="text-sm font-semibold text-gray-500 flex gap-3">
        
<time datetime="2020-03-12 14:07:17 &#43;0000 UTC" title="2020-03-12 14:07:17 &#43;0000 UTC">
    12 March 2020
</time>
        
        —
        
            <a class="hover:text-gray-500" href="/categories/tech/" alt="Tech" >
                Tech
                </a>
        

        </div>
    </header>
    <section class="content text-lg text-gray-800">
    <p>surface Pro 6又坏了，微软的硬件好垃圾，一年多坏了3次，再不会买了，影响工作效率。每次送修的结果就是所有东西都要重配一遍，这次是换机，更彻底一点。然后，又遇到了当初第一次用surface的时候遇到的问题——UWP应用联网。于是把备份的一篇文字直接拿来解决这个问题，再发一遍方便以后找。</p>
<hr>
<p>从Arch到Win10各种不适应，最近这种不适应在一个始料未及的事情上表现的尤为明显——只要开了全局代理，微软自家的UWP程序就无法联网了。</p>
<p>对此，在下也是服气。</p>
<p>然而，发现问题不解决不是吾辈的作风，于是开始找各种解决方案，顺带了解了一下UWP。</p>
<p>这玩意出来也好几年了，一直不温不火的，以至于我从来没有注意到还有这么个玩意。据说所有UWP应用均运行在被称为App Container的虚拟沙箱环境中，其安全性胜于传统的EXE应用。但问题也出在这里，安全的同时它阻止了网络流量发送到本机（即loopback），即阻止了UWP应用访问 localhost。没有访问回环地址的权限，也意味着即便系统设置中启用了本地代理，UWP应用也无法访问本地代理服务器。</p>
<p>按照官方的解决方案，貌似可以用CheckNetIsolation命令来解决这个问题，MSDN轻描淡写的写着命令：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>checknetisolation loopbackexempt -a -n= UWP应用容器名
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>checknetisolation loopbackexempt -a -p= UWP应用SID
</span></span></code></pre></div><p>可是谁告诉我UWP的SID去哪里找？UWP的应用容器名称又是啥？</p>
<p>有一种找SID的方法，通过注册表获取：</p>
<p>win+r的运行里输入Regedit打开注册表编辑器，然后定位到</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-fallback" data-lang="fallback"><span style="display:flex;"><span>HKEY_CURRENT_USERSoftwareClassesLocal 
</span></span><span style="display:flex;"><span>Settings
</span></span><span style="display:flex;"><span>Software
</span></span><span style="display:flex;"><span>MicrosoftWindows
</span></span><span style="display:flex;"><span>CurrentVersion
</span></span><span style="display:flex;"><span>App
</span></span><span style="display:flex;"><span>Container
</span></span><span style="display:flex;"><span>Mappings 
</span></span></code></pre></div><p>接着在左边的注册表项中找到你想解除网络隔离的应用，右边的 DisplayName 就是应用名称，而左边那一大串字符就是应用的SID值了。<br>
SID值是人类可以理解的么？对此我可以骂人么？这是人干的事？我不能骂人么？那我还有什么话好说。</p>
<p>这方法还是放弃的好！</p>
<p>官方的解决方案如此复杂，按照问题发生后最简单的思路去解决，那就是关闭代理。</p>
<p>这简单粗暴的方法确实可行，唯一的问题是关闭代理这事在国内是我不能接受的。</p>
<p>接着搜索，互联网给出的答案是网络调试工具Fiddler，然后左上角的WinConfig按钮，排除不要的UWP应用。</p>
<p>可是，Fiddler这工具用来干这个岂不是太大材小用了？</p>
<p>最终，我找到了这个——<strong>Windows-Loopback-Exemption-Manager</strong></p>
<p>Github上的项目，看来遭这问题困扰的人好多啊</p>
<p><a href="https://github.com/tiagonmas/Windows-Loopback-Exemption-Manager">https://github.com/tiagonmas/Windows-Loopback-Exemption-Manager</a></p>
<p>好了，这玩意跟Fiddler用法差不多，功能更单一，仅此而已。</p>
<p>哦，这东西还有一个坑，就是邮件，用这种方法邮件还是没办法添加Gmail不知道是为啥。</p>
<p>以上就是三种解决方案，其实只能算两种:</p>
<p>如果<strong>想简单粗暴</strong>，那么关闭代理是最直接的,这简直不能算解决方案；<br>
不然，<strong>就Fiddle或是Windows-Loopback-Exemption-Manager</strong>这两者虽然有坑都还可以接受；</p>
<p>我想没有人愿意手动去一条条命令敲吧，光是找SID的工作就是非人类的。</p>

    
        <div class="pb-14 taxonomy-list tags-list text-gray-600 text-sm font-medium">
            
                    <a class="bg-gray-100 py-2 px-3 rounded-lg" href="/tags/uwp/" alt="UWP" >
                        UWP
                    </a>
            
                    <a class="bg-gray-100 py-2 px-3 rounded-lg" href="/tags/proxy/" alt="Proxy" >
                        Proxy
                    </a>
            
        </div>


    </section>
    
    
    
        <div class="giscus-comment">
    <script
      src="https://giscus.app/client.js"
      data-repo="suikaremilia/suikaremilia.github.io"
      data-repo-id="R_kgDOHZJINw"
      data-category="Announcements"
      data-category-id="DIC_kwDOHZJIN84CYPk_"
      data-mapping="pathname"
      data-strict="0"
      data-reactions-enabled="1"
      data-emit-metadata="0"
      data-input-position="top"
      data-theme="light"
      data-lang="zh-CN"
      
        data-loading="lazy"
      
      crossorigin="anonymous"
      async
    ></script>
</div>
    

    
    

    <footer>

    </footer>
</article>

        </div><footer class="pt-5 pb-10 grid gap-3 sm:grid-cols-2">
    <div class="text-xs font-semibold text-gray-500 order-2 sm:order-1 ">
    © 2023 — <a class="hover:text-gray-500" href="https://suikaremilia.github.io/">Long life, short world, trading of time, long strangle, hedging bets</a> <span class=" font-normal ">
</div>
    <div class="text-xs font-semibold text-gray-500 order-1 sm:order-2">
    <ul class="flex sm:justify-end gap-5">
    <li><a class="hover:text-gray-500" href="https://t.me/touhoumichong" target="_blank" rel="noopener noreferrer">Telegram</a></li><li><a class="hover:text-gray-500" href="mailto:suika@kadama.eu.org" target="_blank" rel="noopener noreferrer">Mail</a></li><li><a class="hover:text-gray-500" href="/index.xml" target="_blank" rel="noopener noreferrer">RSS</a></li>
    </ul>
</div>
</footer></body>
</html>
